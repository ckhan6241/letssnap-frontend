<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-icons/social-icons.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../shared-styles.html">

<dom-module id="single-image-scroll-view">
  <template>
    <style include="shared-styles">
      .container {
        display: flex;
        flex-direction: column;
      }

      .button-group {
        display: flex;
        justify-content: flex-end;
        width: 100%;
        background-color: var(--background-color);
        height: 42px;
      }

      paper-icon-button {
        width: 42px;
        height: 42px;
        background-color: var(--background-color);
      }

      iron-image {
        width: 100%;
        height: 100vw;
        --iron-image-width: 100%;
        background-color: lightgrey;
      }

    </style>
    <div class="container" id="{{_generateId(index)}}">
      <iron-image preload fade src="{{url}}"></iron-image>
      <div class="button-group">
        <paper-icon-button icon="social:share"></paper-icon-button>
        <paper-icon-button icon="icons:file-download"></paper-icon-button>
      </div>
    </div>
  </template>

  <script>
    class SingleImageScrollView extends Polymer.Element {
      static get is() {
        return 'single-image-scroll-view';
      }

      _generateId(index) {
        return 'img-'+index;
      }

      _indexChanged() {
        if (this.focusIndex === String(this.index)) {
          setTimeout(() => this.shadowRoot.getElementById('img-'+this.index).scrollIntoView(), 0); //freaking no clue why this works
        }
      }

      attached() {
        console.log('attached');
      }

      static get properties() {
        return {
          url: String,
          focusIndex: {
            type: String,
            observer: '_indexChanged'
          },
        };
      }
    }

    window.customElements.define(SingleImageScrollView.is, SingleImageScrollView);
  </script>
</dom-module>